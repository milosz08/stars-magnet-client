<!--
 ~ Copyright (c) 2023 by MILOSZ GILGA <https://miloszgilga.pl>
 ~ Silesian University of Technology
 ~ 
 ~   File name: response-to-opinion.component.html
 ~   Created at: 2023-06-10, 08:28:39
 ~   Last updated at: 2023-08-30, 22:28:51
 ~   Project name: stars-magnet-client
 ~ 
 ~ Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 ~ file except in compliance with the License. You may obtain a copy of the License at
 ~ 
 ~   <http://www.apache.org/license/LICENSE-2.0>
 ~ 
 ~ Unless required by applicable law or agreed to in writing, software distributed under
 ~ the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS
 ~ OF ANY KIND, either express or implied. See the License for the specific language
 ~ governing permissions and limitations under the license.
 -->

<ng-container
  *ngIf="
    (isLogged$ | async) &&
    (loggedRole$ | async) === companyRole &&
    !(opinion?.companyResponse !== null || alreadyAdded) &&
    (loggedDetails$ | async)?.id === companyId
  ">
  <form
    class="mt-3"
    [formGroup]="responseForm"
    (ngSubmit)="onSubmitResponseOpinion()">
    <div class="mb-3">
      <app-countable-textarea
        controlName="companyResponse"
        placeholder="This is a very nice company..."
        [formGroup]="responseForm">
        <ng-container labelC>Insert here reponse comment:</ng-container>
        <ng-container requiredC>Response field is required.</ng-container>
        <ng-container patternC
          >Response comment field must contains at least 10
          characters.</ng-container
        >
      </app-countable-textarea>
    </div>
    <button
      [disabled]="!responseForm.valid"
      class="btn btn-primary w-100 d-flex justify-content-center align-items-center gap-2">
      <div
        *ngIf="lazyLoader$ | async"
        class="spinner-border spinner-border-sm text-light"></div>
      Submit
    </button>
  </form>
</ng-container>
<ng-container *ngIf="opinion?.companyResponse !== null || alreadyAdded">
  <hr />
  <div class="row align-items-center mb-1">
    <div
      class="col-md-6 d-flex justify-content-center justify-content-md-start">
      <p class="fs-xsm text-secondary mb-0">Company response</p>
    </div>
    <div class="col-md-6 d-flex justify-content-center justify-content-md-end">
      <p class="fs-xsm text-secondary mb-0">
        {{ opinion?.responseDate | date: 'd MMM yyyy, hh:mm a' }}
      </p>
    </div>
  </div>
  <p class="text-secondary mb-0 mt-1">{{ opinion?.companyResponse }}</p>
</ng-container>
